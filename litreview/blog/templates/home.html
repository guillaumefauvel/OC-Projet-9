{% extends 'base.html' %}
{% block title %}LitReview - Flux{% endblock title %}

{% load blog_extras %}
{% block content %}

<h1> Flux </h1>
<hr><br><br>

{% if publications %}
    {% for item in publications %}
        {% if item.content_picture %}
            <img src="{{ item.content_picture.url }}" class="ticket-picture">
        {% endif %}
        <div class="reference">
            <h2>
            {{ item.content_reference }}
            {% if item.publication_year %}
                ({{item.publication_year}})
            {% endif %}
            </h2>
            <em> &nbsp; de {{ item.content_author }}</em>
        </div>
        <div class="user_element">
            {% if item|model_type == 'Review' %}
                <br>
                <form action="{% url 'show-review' item.id %}">
                  <input class="publish" type="submit" value="'{{item.headline}}' - {{ item.rating}}/5">
                </form>
                <p class="item-details">Critique publié par <a href="{% url 'user-page' item.user.id %}">{{ item.user }}</a>
                    le {{ item.time_created }}
                    {% if item.ticket.user %}
                        en réponse à <a href="{% url 'user-page' item.ticket.user.id %}">{{ item.ticket.user }}</a>
                    {% endif %}
                </p>
                <br><hr><br>
            {% else %}
                <h5>{{ item.user_comment }}</h5>
                {% if item.status %}
                    <form action="{% url 'ticket-page' item.id %}">
                      <input class="publish" type="submit" value="Publier une critique">
                    </form>
                {% endif %}
                <p class="item-details">Ticket ouvert par <a href="{% url 'user-page' item.user.id %}">{{ item.user }}</a> le {{ item.time_created }}</p>
                <br><hr><br>
            {% endif %}
        </div>
    {% endfor %}

{% else %}
    <p> Votre flux est vide, abonnez-vous à un quelqu'un ayant
        déjà publié du contenu afin d'alimenter votre flux.</p>
{% endif %}

{% endblock content %}