{% extends 'base.html' %}
{% block title %}LitReview - {{ guest_id }}{% endblock title %}

{% block content %}

<h1> Profil de {{ guest_id }} </h1>
<h3> {{ followers }} abonné{{ followers|pluralize:" ,s" }} {{ followings }} abonnement{{ followings|pluralize:" ,s"}} </h3>
{% if guest_id.description %}
    <hr>
    <p>{{ guest_id.description }}</p>
{% endif %}

<hr><br><br>

{% if action == 'follow' %}
    <form action='{{guest_id.id}}/{{action}}' method='GET'>
    <button type='submit'> S'abonner </button>
    </form>
{% elif action == 'unfollow' %}
    <form action='{{guest_id.id}}/{{action}}' method='GET'>
    <button type='submit'> Se désabonner </button>
    </form>
{% elif action == 'self' %}
{% endif %}

<br>
<h2>Mes tickets</h2>

<div class="content-items">
{% if tickets %}
    {% for ticket in tickets %}
            {% if ticket.status %}
            <p><a href="{% url page_ref ticket.id %}">{{ ticket }}</a>
                {% if ticket.publication_year %}
                    ({{ticket.publication_year}})
                {% endif %}
                de {{ ticket.content_author }} </p>
            {% else %}
                {{ ticket }}
                {% if ticket.publication_year %}
                    ({{ ticket.publication_year }})
                {% endif %}
                de {{ ticket.content_author }}
                - Ticket fermé >
                {% for review in foreign_reviews %}
                    {% if review.ticket.id == ticket.id %}
                        <a href="{% url 'show-review' review.id %}"> Critique </a>
                    {% endif %}
                {% endfor %}
            {% endif %}
            <br>
    {% endfor %}
{% else %}
    <i> Je n'ai pas encore ouvert de ticket </i>
{% endif %}
</div>

<h2>Mes critiques</h2>
<div class="content-items">
{% if reviews %}
    {% for review in reviews %}
        <p><a href="{% url 'show-review' review.id %}">{{ review }}</a>
            {% if review.publication_year %}
                ({{review.publication_year}})
            {% endif %}
            de {{ review.content_author }}
        </p>
        <br>
    {% endfor %}
{% else %}
    <i> Je n'ai pas encore publié de critique </i>
{% endif %}
</div>

{% endblock %}

